<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Login</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        input, button { width: 100%; padding: 10px; margin: 5px 0; }
        .result { margin-top: 20px; padding: 15px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <h2>üîç Debug del Sistema de Login</h2>
    
    <div class="form-group">
        <label>C√≥digo de Usuario:</label>
        <input type="text" id="username" placeholder="Ej: U23201604" value="U23201604">
    </div>
    
    <div class="form-group">
        <label>Contrase√±a:</label>
        <input type="password" id="password" placeholder="Contrase√±a" value="Usuario123@">
    </div>
    
    <button onclick="testLogin()">üß™ Probar Login</button>
    <button onclick="showAccounts()">üë• Ver Cuentas Disponibles</button>
    <button onclick="clearStorage()">üóëÔ∏è Limpiar LocalStorage</button>
    
    <div id="result"></div>

    <script>
        const accounts = {
            "U23201604": { password: "Usuario123@", role: "user" },
            "U23256703": { password: "Miodemi456#", role: "user" },
            "T20137912": { password: "Tecnico456#", role: "tech" }
        };

        function getAllAccounts() {
            let storedAccounts = {};
            try {
                storedAccounts = JSON.parse(localStorage.getItem('registeredAccounts')) || {};
            } catch (e) {
                console.error("Error:", e);
            }
            return { ...accounts, ...storedAccounts };
        }

        function testLogin() {
            const username = document.getElementById('username').value.trim().toUpperCase();
            const password = document.getElementById('password').value;
            const allAccounts = getAllAccounts();
            const account = allAccounts[username];
            
            let resultHTML = `
                <div class="info">
                    <h4>üìä Informaci√≥n de Debug:</h4>
                    <p><strong>Usuario ingresado:</strong> "${username}"</p>
                    <p><strong>Contrase√±a ingresada:</strong> "${password}"</p>
                    <p><strong>Cuenta encontrada:</strong> ${account ? 'S√≠' : 'No'}</p>
            `;
            
            if (account) {
                resultHTML += `
                    <p><strong>Contrase√±a esperada:</strong> "${account.password}"</p>
                    <p><strong>Rol:</strong> ${account.role}</p>
                    <p><strong>Contrase√±as coinciden:</strong> ${account.password === password ? 'S√≠' : 'No'}</p>
                `;
            }
            
            resultHTML += '</div>';
            
            if (account && account.password === password) {
                const redirectPage = account.role === 'user' ? 'catalogo.html' : 'Interno.html';
                resultHTML += `
                    <div class="success">
                        <h4>‚úÖ Login Exitoso!</h4>
                        <p>Redirigiendo a: ${redirectPage}</p>
                        <button onclick="window.location.href='${redirectPage}'">Ir a la p√°gina</button>
                    </div>
                `;
            } else {
                resultHTML += `
                    <div class="error">
                        <h4>‚ùå Login Fallido</h4>
                        <p>Las credenciales no coinciden</p>
                    </div>
                `;
            }
            
            document.getElementById('result').innerHTML = resultHTML;
        }

        function showAccounts() {
            const allAccounts = getAllAccounts();
            let accountsHTML = '<div class="info"><h4>üë• Cuentas Disponibles:</h4>';
            
            for (const [username, data] of Object.entries(allAccounts)) {
                accountsHTML += `
                    <p><strong>${username}:</strong> ${data.password} (${data.role})</p>
                `;
            }
            
            accountsHTML += '</div>';
            document.getElementById('result').innerHTML = accountsHTML;
        }

        function clearStorage() {
            localStorage.removeItem('registeredAccounts');
            document.getElementById('result').innerHTML = `
                <div class="success">
                    <h4>üóëÔ∏è LocalStorage Limpiado</h4>
                    <p>Se eliminaron todas las cuentas registradas</p>
                </div>
            `;
        }

        // Mostrar cuentas al cargar
        showAccounts();
    </script>
</body>
</html>